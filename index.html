<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Задача 2: Кэш данных об облигациях</title>
    <script src="index.js"></script>
</head>

<body>
<script>
    const memPreview = new (class MemPreview {})();
    document.addEventListener('decision-complete', () => {
        // Фрагмент кода для замеров потребляемой памяти
        const LENGTH = 100000;
        const DATE = '20190830';
        const SIZE = 12;
        const isins = Array(LENGTH);
        for (let i = 0; i < LENGTH; i += 1) {
            isins[i] = [...Array(SIZE)].map(() => Math.floor(16*Math.random()).toString(16)).join('');
        }
        getBondsData({date:DATE, isins}).then(() => {
            getBondsData({date:DATE, isins}).then(() => {
                memPreview.isins = isins;
                memPreview._cache = _cache;
                console.log(`\nПотребление памяти (при длине пробного массива ${LENGTH} элементов) вы можете увидеть сделав heap snapshot во вкладке memory и развернув объект MemPreview`);
            });
        });
    });
</script>
</body>
</html>